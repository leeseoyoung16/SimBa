"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[864],{864:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var r=a(338),n=a(43),i=a(674),t=a(579);const l="/map",c="/manage",d=8;function o(){var e;const s=(0,r.Zp)(),a=(0,r.KC)(),o=null!==(e=null===a||void 0===a?void 0:a.user)&&void 0!==e?e:null,[m,u]=(0,n.useState)(!0),[h,v]=(0,n.useState)(""),[j,p]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{u(!0),v("");const{data:a}=await i.Ay.get("/itda/missions/joinable"),r=Array.isArray(a)?a:(null===a||void 0===a?void 0:a.items)||[],n=new Map;for(const e of r){var s;const a=e.store||{},r=null!==(s=a.id)&&void 0!==s?s:e.storeId;if(!r)continue;const i=e.imgUrl||e.posterUrl||e.poster||e.imageUrl||e.thumbnailUrl||e.iamegUrl||"";n.has(r)?n.get(r).count+=1:n.set(r,{storeId:r,name:a.name||e.storeName||"\ub9e4\uc7a5",address:a.address||e.address||"",poster:i,count:1})}const t=Array.from(n.values()).sort((e,s)=>s.count-e.count).slice(0,d);if(!e)return;p(t)}catch(n){var a,r;if(!e)return;v((null===n||void 0===n||null===(a=n.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"\ubbf8\uc158/\ub9e4\uc7a5 \ubbf8\ub9ac\ubcf4\uae30\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."),p([])}finally{e&&u(!1)}})(),()=>{e=!1}},[]);const x=j.length>0;return(0,t.jsxs)("div",{className:"main-wrap",children:[(0,t.jsx)("h2",{className:"main-title",children:"\ubb34\uc5c7\uc744 \ud558\uc2dc\uaca0\uc5b4\uc694?"}),(0,t.jsxs)("div",{className:"main-grid",children:[(0,t.jsxs)("button",{type:"button",className:"main-card",onClick:()=>s(l),"aria-label":"\ubbf8\uc158 \uc774\ubca4\ud2b8 \uc9c0\ub3c4 \ubcf4\uae30",children:[(0,t.jsx)("div",{className:"card-emoji","aria-hidden":!0,children:"\ud83d\uddfa\ufe0f"}),(0,t.jsx)("div",{className:"card-title",children:"Itda \uc774\ubca4\ud2b8 \ucc3e\uc544\ubcf4\uae30!"}),(0,t.jsx)("div",{className:"card-desc",children:"\uc9c4\ud589 \uac00\ub2a5\ud55c \ubbf8\uc158\uc744 \uc9c0\ub3c4\uc5d0\uc11c \ud655\uc778\ud574\uc694."})]}),(0,t.jsxs)("button",{type:"button",className:"main-card",onClick:()=>{if(!o)return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."),void s("/login");(e=>{if(!e)return!1;const s=(e.role?String(e.role):"").toUpperCase();if(s)return"OWNER"===s||"ADMIN"===s;const a=Array.isArray(e.roles)?e.roles.map(e=>String(e).toUpperCase()):[];return a.includes("OWNER")||a.includes("ADMIN")})(o)?s(c):alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. (\ub9ac\ubdf0\uc5b4\ub294 \uc811\uadfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.)")},"aria-label":"\ub0b4 \ub9e4\uc7a5 \uad00\ub9ac\ub85c \uc774\ub3d9",children:[(0,t.jsx)("div",{className:"card-emoji","aria-hidden":!0,children:"\ud83c\udfea"}),(0,t.jsx)("div",{className:"card-title",children:"\ub9e4\uc7a5 \uad00\ub9ac"}),(0,t.jsx)("div",{className:"card-desc",children:"\ub4f1\ub85d\ud55c \ub9e4\uc7a5\uc744 \ud655\uc778\ud558\uace0 \ud3b8\uc9d1\ud574\uc694."})]})]}),(0,t.jsx)("div",{className:"main-sections vertical",children:(0,t.jsxs)("section",{className:"home-section",children:[(0,t.jsxs)("div",{className:"section-header",children:[(0,t.jsx)("h3",{className:"section-title",children:"\ubbf8\uc158\uc774 \uc62c\ub77c\uc628 \ub9e4\uc7a5"}),(0,t.jsx)("button",{type:"button",className:"link-btn",onClick:()=>s(l),children:"\uc804\uccb4 \ubcf4\uae30 \u2192"})]}),m&&(0,t.jsx)("div",{className:"section-empty",children:"\ubd88\ub7ec\uc624\ub294 \uc911..."}),!m&&h&&(0,t.jsx)("div",{className:"section-error",children:h}),!m&&!h&&!x&&(0,t.jsx)("div",{className:"section-empty",children:"\ud604\uc7ac \uc9c4\ud589 \uac00\ub2a5\ud55c \ubbf8\uc158\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),!m&&!h&&x&&(0,t.jsx)("ul",{className:"store-preview-grid",children:j.map(e=>{return(0,t.jsxs)("li",{className:"store-card",title:e.name,onClick:()=>s("".concat(l,"?storeId=").concat(encodeURIComponent(e.storeId))),children:[(0,t.jsxs)("div",{className:"store-thumb",children:[e.poster?(0,t.jsx)("img",{src:e.poster,alt:"\ud3ec\uc2a4\ud130"}):(0,t.jsx)("div",{className:"store-thumb-placeholder",children:"\ud3ec\uc2a4\ud130 \uc5c6\uc74c"}),(0,t.jsx)("span",{className:"badge-count","aria-label":"\uc9c4\ud589\uc911 \ubbf8\uc158 ".concat(e.count,"\uac1c"),children:(a=e.count,a>99?"99+":String(a||0))})]}),(0,t.jsxs)("div",{className:"store-body",children:[(0,t.jsx)("div",{className:"store-name",children:e.name}),e.address&&(0,t.jsx)("div",{className:"store-addr",children:e.address})]})]},e.storeId);var a})})]})})]})}function m(){return(0,t.jsx)("div",{"data-app":"manage-shop",children:(0,t.jsxs)(r.BV,{children:[(0,t.jsx)(r.qh,{index:!0,element:(0,t.jsx)(o,{})}),(0,t.jsx)(r.qh,{path:"*",element:(0,t.jsx)(r.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=864.2abece88.chunk.js.map