"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[836],{836:(e,n,t)=>{t.r(n),t.d(n,{default:()=>h});var l=t(338),s=t(43),i=t(379);let r=null;var a=t(674),o=t(579);const d="261b88294b81d5800071641ecc633dcb";function c(e){let{onMissionSelect:n,storeIdToFocus:t,focus:l}=e;const[c,u]=(0,s.useState)([]),[v,m]=(0,s.useState)(new Set),[h,p]=(0,s.useState)(!1),g=(0,s.useRef)(null),f=(0,s.useRef)(null),w=(0,s.useRef)(null),x=(0,s.useRef)(null),N=(0,s.useRef)(!1),y=(0,s.useRef)([]),j=(0,s.useRef)(n);(0,s.useEffect)(()=>{j.current=n},[n]);const b=(0,s.useRef)(null),k=(0,s.useRef)(null),A=(0,s.useRef)(null),S=(0,s.useRef)(null),C=(0,s.useRef)(null),I=(0,s.useRef)(null),R=()=>{k.current&&(clearTimeout(k.current),k.current=null),b.current&&(b.current.setMap(null),b.current=null)};return(0,s.useEffect)(()=>{if(!N.current)return N.current=!0,(async()=>{const e=await function(e){var n;return"undefined"===typeof window?Promise.reject(new Error("Kakao SDK must run in browser")):null!==(n=window.kakao)&&void 0!==n&&n.maps?Promise.resolve(window.kakao):r||(r=new Promise((n,t)=>{const l="kakao-maps-sdk",s=document.getElementById(l);var i;if(s)return null!==(i=window.kakao)&&void 0!==i&&i.maps?n(window.kakao):(s.addEventListener("load",()=>n(window.kakao),{once:!0}),void s.addEventListener("error",()=>t(new Error("Failed to load Kakao SDK(existing)")),{once:!0}));const r=document.createElement("script");r.id=l,r.async=!0,r.src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=".concat(e,"&libraries=services,clusterer&autoload=false"),r.onload=()=>{if(!window.kakao)return t(new Error("Kakao SDK loaded but window.kakao is undefined"));window.kakao.maps.load(()=>n(window.kakao))},r.onerror=()=>t(new Error("Failed to load Kakao SDK")),document.head.appendChild(r)}),r)}(d),n=(n,t)=>{const l=w.current;if(!l)return;const s=new e.maps.Map(l,{center:new e.maps.LatLng(n,t),level:3});g.current=s,f.current=new e.maps.services.Geocoder,p(!0);const i=(e,n)=>{var t;null===(t=f.current)||void 0===t||t.coord2RegionCode(e.getLng(),e.getLat(),n)},r=(n,t)=>{if(t===e.maps.services.Status.OK){const e=x.current;if(!e)return;for(let t=0;t<n.length;t++)if("H"===n[t].region_type){e.textContent=n[t].address_name;break}}};i(s.getCenter(),r),A.current=()=>i(s.getCenter(),r),e.maps.event.addListener(s,"idle",A.current),S.current=()=>R(),C.current=()=>R(),I.current=()=>R(),e.maps.event.addListener(s,"click",S.current),e.maps.event.addListener(s,"dragstart",C.current),e.maps.event.addListener(s,"zoom_changed",I.current)};var t,l;t=(e,t)=>n(e,t),l=()=>n(37.5665,126.978),navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>t(e.coords.latitude,e.coords.longitude),e=>{console.error("\uc704\uce58 \uc815\ubcf4 \uc5d0\ub7ec:",e),null===l||void 0===l||l(e)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):null===l||void 0===l||l(new Error("Geolocation not supported"))})(),()=>{const e=window.kakao;e&&g.current&&(A.current&&e.maps.event.removeListener(g.current,"idle",A.current),S.current&&e.maps.event.removeListener(g.current,"click",S.current),C.current&&e.maps.event.removeListener(g.current,"dragstart",C.current),I.current&&e.maps.event.removeListener(g.current,"zoom_changed",I.current)),y.current.forEach(e=>e.setMap(null)),y.current=[],R(),g.current=null,f.current=null,p(!1)}},[]),(0,s.useEffect)(()=>{const e=window.kakao,n=g.current;e&&n&&h&&setTimeout(()=>{n.relayout(),n.setCenter(n.getCenter())},0)},[h]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{const{data:t}=await a.Ay.get("/itda/stores"),l=Array.isArray(t)?t:(null===t||void 0===t?void 0:t.items)||[];if(!e)return;const s=e=>null===e||void 0===e||""===e?void 0:Number(e),r=new Map;for(const e of l){var n;const t=null!==(n=e.id)&&void 0!==n?n:e.storeId;t&&(r.has(t)||r.set(t,(0,i.A)((0,i.A)({},e),{},{id:t,latitude:s(null===e||void 0===e?void 0:e.latitude),longitude:s(null===e||void 0===e?void 0:e.longitude)})))}u(Array.from(r.values()))}catch(t){e&&u([])}})(),()=>{e=!1}},[]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{const{data:l}=await a.Ay.get("/itda/missions/joinable"),s=Array.isArray(l)?l:(null===l||void 0===l?void 0:l.items)||[],i=new Set;for(const e of s){var n,t;const l=null!==(n=null===e||void 0===e||null===(t=e.store)||void 0===t?void 0:t.id)&&void 0!==n?n:null===e||void 0===e?void 0:e.storeId;l&&i.add(Number(l))}e&&m(i)}catch(l){e&&m(new Set)}})(),()=>{e=!1}},[]),(0,s.useEffect)(()=>{const e=window.kakao,n=g.current,t=f.current;if(!e||!n||!t)return;y.current.forEach(e=>e.setMap(null)),y.current=[];const l="data:image/svg+xml;utf8,"+encodeURIComponent('<svg width="24" height="34" viewBox="0 0 24 34" xmlns="http://www.w3.org/2000/svg">\n          <defs><filter id="s" x="-50%" y="-50%" width="200%" height="200%"><feDropShadow dx="0" dy="1" stdDeviation="1" flood-opacity=".25"/></filter></defs>\n          <path d="M12 33c5-8 10-12 10-19A10 10 0 1 0 2 14c0 7 5 11 10 19z" fill="#ef4444" filter="url(#s)"/>\n          <circle cx="12" cy="12" r="4.2" fill="white"/>\n        </svg>'),s=new e.maps.MarkerImage(l,new e.maps.Size(24,34),{offset:new e.maps.Point(12,34)}),r=(n,l)=>{e.maps.event.addListener(n,"click",()=>{R();const n=Number(l.latitude),s=Number(l.longitude);Number.isFinite(n)&&Number.isFinite(s)&&t.coord2Address(s,n,(t,i)=>{var r;let a="",o="";var d,c,u,v;i===e.maps.services.Status.OK&&null!==t&&void 0!==t&&t[0]&&(a=(null===(d=t.find(e=>e.road_address))||void 0===d||null===(c=d.road_address)||void 0===c?void 0:c.address_name)||"",o=(null===(u=t[0])||void 0===u||null===(v=u.address)||void 0===v?void 0:v.address_name)||"");null===(r=j.current)||void 0===r||r.call(j,{mission:null,store:l,lat:n,lng:s,address:{road:a,jibun:o}})})})};for(const a of c){const t=Number(a.latitude),l=Number(a.longitude);if(!Number.isFinite(t)||!Number.isFinite(l))continue;const o=new e.maps.LatLng(t,l),d=v.has(Number(a.id)),c=new e.maps.Marker((0,i.A)({position:o,map:n,title:a.storeName||a.name||"\ub9e4\uc7a5#".concat(a.id),zIndex:d?3:2},d?{image:s}:{}));r(c,a),y.current.push(c)}},[c,v]),(0,s.useEffect)(()=>{const e=window.kakao,n=g.current;if(e&&n&&t)return(async()=>{try{const{data:l}=await a.Ay.get("/itda/stores/".concat(t)),s=e=>null===e||void 0===e||""===e?void 0:Number(e),i=s(null===l||void 0===l?void 0:l.latitude),r=s(null===l||void 0===l?void 0:l.longitude);if(!Number.isFinite(i)||!Number.isFinite(r))return;const o=new e.maps.LatLng(i,r);n.panTo(o),R()}catch(s){var l;console.warn("store focus failed:",(null===s||void 0===s||null===(l=s.response)||void 0===l?void 0:l.data)||s)}})(),()=>{k.current&&(clearTimeout(k.current),k.current=null)}},[t,h]),(0,s.useEffect)(()=>{const e=window.kakao,n=g.current;if(!e||!n||!l)return;R();const t=Number(l.lat),s=Number(l.lng);if(!Number.isFinite(t)||!Number.isFinite(s))return;const i=new e.maps.LatLng(t,s);n.panTo(i)},[l]),(0,o.jsxs)("div",{className:"map_wrap",children:[(0,o.jsx)("div",{id:"map",ref:w,className:"map_canvas"}),(0,o.jsxs)("div",{className:"hAddr",children:[(0,o.jsx)("span",{className:"title",children:"\uc9c0\ub3c4\uc911\uc2ec\uae30\uc900 \ud589\uc815\ub3d9 \uc8fc\uc18c\uc815\ubcf4"}),(0,o.jsx)("span",{id:"centerAddr",ref:x})]})]})}const u=function(e){let{storeId:n,address:t,onPickMission:l}=e;const[i,r]=(0,s.useState)(!1),[d,c]=(0,s.useState)(""),[u,v]=(0,s.useState)(null),[m,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(null),[f,w]=(0,s.useState)(null),[x,N]=(0,s.useState)([]),[y,j]=(0,s.useState)(""),b=e=>{if(null===e||void 0===e||""===e)return;const n="number"===typeof e?e:Number(e);return Number.isFinite(n)?n:void 0},k=e=>{if(null===e||void 0===e||""===e)return null;if("number"===typeof e){const n=new Date(e>1e12?e:1e3*e);return isNaN(n)?null:n}const n=new Date(String(e));return isNaN(n)?null:n},A=e=>{const n=k(e);return n?n.toISOString().slice(0,10):"-"};(0,s.useEffect)(()=>{let e=!0;return n?((async n=>{r(!0),c("");try{const{data:s}=await a.Ay.get("/itda/stores/".concat(encodeURIComponent(n)));if(!e)return;v(s||null);try{const{data:t}=await a.Ay.get("/itda/stores/".concat(encodeURIComponent(n),"/reviews/summary")),l=(e=>{if(!e)return"";if(e=String(e).trim(),/\uc694\uc57d \uacb0\uacfc \uc5c6\uc74c|\ub9ac\ubdf0\uac00 \ud558\ub098\ub3c4 \uc5c6\uc2b5\ub2c8\ub2e4/.test(e))return e;const n=/^</.test(e)||/<\/?[a-z][\s\S]*>/i.test(e),t=/(\uc624\ub958|error|exception|fail(ed)?)/i.test(e);return!e||n||t?"":(e.length>180&&(e=e.slice(0,180).trim()+"\u2026"),e)})(null===t||void 0===t?void 0:t.summary);e&&h(l)}catch(o){e&&h("")}try{const t=await(async e=>{const n=[async()=>(await a.Ay.get("/itda/stores/".concat(encodeURIComponent(e),"/reviews/summary"))).data,async()=>(await a.Ay.get("/itda/stores/".concat(encodeURIComponent(e),"/stats"))).data,async()=>(await a.Ay.get("/itda/stores/".concat(encodeURIComponent(e),"/rating"))).data];for(const a of n)try{var t,l,s,i,r,o,d,c,u;const e=await a(),n=null!==(t=null!==(l=null!==(s=null!==(i=null===e||void 0===e?void 0:e.avgRating)&&void 0!==i?i:null===e||void 0===e?void 0:e.averageRating)&&void 0!==s?s:null===e||void 0===e?void 0:e.avg)&&void 0!==l?l:null===e||void 0===e?void 0:e.rating)&&void 0!==t?t:null,v=null!==(r=null!==(o=null!==(d=null!==(c=null!==(u=null===e||void 0===e?void 0:e.totalReviews)&&void 0!==u?u:null===e||void 0===e?void 0:e.reviewsCount)&&void 0!==c?c:null===e||void 0===e?void 0:e.count)&&void 0!==d?d:null===e||void 0===e?void 0:e.total)&&void 0!==o?o:null===e||void 0===e?void 0:e.reviewCount)&&void 0!==r?r:null;if("number"===typeof n||"number"===typeof v)return{avg:"number"===typeof n?n:null,count:"number"===typeof v?v:null}}catch(v){}try{const{data:n}=await a.Ay.get("/itda/reviews",{params:{storeId:e,status:"APPROVED"}}),t=Array.isArray(n)?n:(null===n||void 0===n?void 0:n.items)||(null===n||void 0===n?void 0:n.content)||[];if(!t.length)return{avg:null,count:0};const l=t.reduce((e,n)=>{var t,l;const s=null!==(t=null!==(l=n.rating)&&void 0!==l?l:n.stars)&&void 0!==t?t:0;return e+("number"===typeof s?s:Number(s)||0)},0);return{avg:Math.round(l/t.length*10)/10,count:t.length}}catch(m){return{avg:null,count:null}}})(n);e&&(g("number"===typeof t.avg?Math.round(10*t.avg)/10:null),w("number"===typeof t.count?t.count:null))}catch(d){e&&(g(null),w(null))}try{const{data:t}=await a.Ay.get("/itda/missions",{params:{storeId:n}}),l=Array.isArray(t)?t:(null===t||void 0===t?void 0:t.items)||[],s=new Date,i=l.filter(e=>function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;const t=k(e.startAt||e.startDate),l=k(e.endAt||e.endDate);return!(t&&t>n)&&!(l&&l<n)}(e,s)).map(e=>{var n;return{id:null!==(n=e.id)&&void 0!==n?n:e.missionId,title:e.title||"\ubbf8\uc158",start:e.startAt||e.startDate||null,end:e.endAt||e.endDate||null,_raw:e}});e&&N(i)}catch(u){var t,l;if(e)N([]),j((null===u||void 0===u||null===(t=u.response)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.message)||"\ubbf8\uc158 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.")}}catch(u){var s,i;if(e)c((null===u||void 0===u||null===(s=u.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||"\ub9e4\uc7a5 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."),v(null),h(""),g(null),w(null),N([])}finally{e&&r(!1)}})(n),()=>{e=!1}):(v(null),h(""),g(null),w(null),N([]),c(""),void j(""))},[n]);const S=(null===u||void 0===u?void 0:u.storeName)||(null===u||void 0===u?void 0:u.name)||"-",C=(null===t||void 0===t?void 0:t.road)||(null===u||void 0===u?void 0:u.roadAddress)||(null===u||void 0===u?void 0:u.address)||(null===u||void 0===u?void 0:u.jibunAddress)||(null===t||void 0===t?void 0:t.jibun)||"-",I=e=>{var n,s,i,r,a,o,d,c,v,m,h,p;if(!l||null===e||void 0===e||!e._raw)return;const g=null!==(n=null!==(s=null!==(i=b(null===u||void 0===u?void 0:u.latitude))&&void 0!==i?i:b(null===u||void 0===u?void 0:u.lat))&&void 0!==s?s:b(null===e||void 0===e||null===(r=e._raw)||void 0===r||null===(a=r.store)||void 0===a?void 0:a.latitude))&&void 0!==n?n:b(null===e||void 0===e||null===(o=e._raw)||void 0===o?void 0:o.latitude),f=null!==(d=null!==(c=null!==(v=b(null===u||void 0===u?void 0:u.longitude))&&void 0!==v?v:b(null===u||void 0===u?void 0:u.lng))&&void 0!==c?c:b(null===e||void 0===e||null===(m=e._raw)||void 0===m||null===(h=m.store)||void 0===h?void 0:h.longitude))&&void 0!==d?d:b(null===e||void 0===e||null===(p=e._raw)||void 0===p?void 0:p.longitude);l({mission:e._raw,lat:g,lng:f,address:t,store:u})},R="number"===typeof f?String(f):"-",E=!!m;return(0,o.jsxs)("div",{className:"event-list",role:"region","aria-label":"\ub9e4\uc7a5 \uc815\ubcf4",children:[!n&&(0,o.jsx)("div",{className:"event-list-empty",children:"\ub9c8\ucee4\ub97c \ub20c\ub7ec \ub9e4\uc7a5\uc744 \uc120\ud0dd\ud558\uc138\uc694."}),n&&i&&(0,o.jsx)("div",{className:"event-list-empty",children:"\ubd88\ub7ec\uc624\ub294 \uc911..."}),n&&!i&&d&&(0,o.jsx)("div",{className:"event-list-error",children:d}),n&&!i&&!d&&(0,o.jsxs)("div",{className:"store-panel",children:[(0,o.jsxs)("div",{className:"store-head",children:[(0,o.jsx)("div",{className:"store-name",children:S}),(0,o.jsx)("div",{className:"store-addr",children:C}),(0,o.jsx)("div",{className:"store-stars","aria-label":null!=p?"\ud3c9\uade0 \ubcc4\uc810 ".concat(p,"\uc810"):"\ud3c9\uade0 \ubcc4\uc810 \uc5c6\uc74c",children:null!=p?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("strong",{className:"store-stars-num",children:p}),(0,o.jsx)("span",{className:"store-stars-badge",children:(e=>{const n=Math.max(0,Math.min(5,Math.floor(Number(e)||0)));return"\u2605".repeat(n)+"\u2606".repeat(5-n)})(p)})]}):"\ud3c9\uade0 \ubcc4\uc810 \uc815\ubcf4 \uc5c6\uc74c"}),(0,o.jsxs)("div",{className:"store-review-quick",children:["\ub9ac\ubdf0 \uc694\uc57d ",E?"":"(\uc5c6\uc74c)"," "," "," | "," "," \ub9ac\ubdf0 \uac1c\uc218 : ",R]}),E&&(0,o.jsx)("div",{className:"store-summary",title:m,children:m})]}),(0,o.jsx)("div",{className:"store-divider"}),(0,o.jsxs)("div",{className:"store-missions",children:[(0,o.jsx)("div",{className:"store-missions-title",children:"\uc9c4\ud589 \uc911\uc778 \ubbf8\uc158"}),y&&(0,o.jsx)("div",{className:"event-list-error",children:y}),!y&&0===x.length&&(0,o.jsx)("div",{className:"event-list-empty store-missions-empty",children:"\ud604\uc7ac \uc9c4\ud589 \uc911\uc778 \ubbf8\uc158\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),!y&&x.length>0&&(0,o.jsx)("ul",{className:"store-mission-list",children:x.map(e=>(0,o.jsxs)("li",{className:"store-mission-item",onClick:()=>I(e),onKeyDown:n=>"Enter"===n.key&&I(e),role:"button",tabIndex:0,title:e.title,"aria-label":"".concat(e.title," \uc120\ud0dd"),children:[(0,o.jsx)("div",{className:"store-mission-title",children:e.title}),(0,o.jsxs)("div",{className:"store-mission-dates",children:[A(e.start)," ~ ",A(e.end)]})]},e.id))})]})]})]})};function v(e){var n,t,i,r,d,c,u,v,m,h,p,g,f,w,x,N,y,j,b;let{selected:k,loginRoute:A="/login"}=e;const S=(0,l.Zp)(),C=(0,l.zy)(),I=(0,l.KC)(),R=(null===I||void 0===I?void 0:I.user)||null,[E,M]=(0,s.useState)(!1),[D,L]=(0,s.useState)([]),[U,_]=(0,s.useState)(!1),[F,P]=(0,s.useState)(""),[K,T]=(0,s.useState)(!1),[z,B]=(0,s.useState)(0),[O,q]=(0,s.useState)(0),[G,H]=(0,s.useState)(()=>new Set),V=(null===k||void 0===k?void 0:k.mission)||k||{},Q=(null===V||void 0===V?void 0:V.store)||(null===k||void 0===k?void 0:k.store)||{},Z=V.imgUrl||V.posterUrl||V.poster||V.imageUrl||V.thumbnailUrl||"",$=V.title||"\ubbf8\uc158",J=V.description||V.desc||"",W=V.startAt||V.startDate||"",X=V.endAt||V.endDate||"",Y=V.rewardContent||V.rewardName||"",ee=null!==(n=null!==(t=null!==(i=null!==(r=null!==(d=V.rewardRemainingCount)&&void 0!==d?d:V.rewardCount)&&void 0!==r?r:V.reward)&&void 0!==i?i:V.quantity)&&void 0!==t?t:V.rewardQty)&&void 0!==n?n:null,ne=Q.storeName||Q.name||V.storeName||"-",te=(null===k||void 0===k||null===(c=k.address)||void 0===c?void 0:c.road)||Q.address||V.address||(null===k||void 0===k||null===(u=k.address)||void 0===u?void 0:u.jibun)||"-",le=null!==(v=null!==(m=null!==(h=null!==(p=null!==(g=null!==(f=V.id)&&void 0!==f?f:V.missionId)&&void 0!==g?g:V.missionID)&&void 0!==p?p:null===k||void 0===k?void 0:k.id)&&void 0!==h?h:null===k||void 0===k?void 0:k.missionId)&&void 0!==m?m:null===k||void 0===k?void 0:k.missionID)&&void 0!==v?v:null,se=null!==(w=null!==(x=null!==(N=null!==(y=null!==(j=Q.id)&&void 0!==j?j:Q.storeId)&&void 0!==y?y:V.storeId)&&void 0!==N?N:null===(b=V.store)||void 0===b?void 0:b.id)&&void 0!==x?x:null===k||void 0===k?void 0:k.storeId)&&void 0!==w?w:null,ie=e=>{if(!e)return"-";try{const n=new Date(e);if(!isNaN(n))return n.toISOString().slice(0,10)}catch(n){}return String(e).slice(0,10)},re=e=>{if(!e)return"";const n=String(e).trim();if(!n)return"";if(/^(https?:)?\/\//i.test(n)||/^data:image\//i.test(n))return n;const t=(a.C1||"").trim(),l="undefined"!==typeof window?window.location.origin:"";return"".concat((t||l||"").replace(/\/+$/,""),"/").concat(n.replace(/^\/+/,""))},ae=e=>{var n,t,l,s,i,r,a,o;const d=e.userName||e.username||e.nickname||(null===(n=e.user)||void 0===n?void 0:n.name)||"\uc0ac\uc6a9\uc790",c=null!==(t=null!==(l=e.rating)&&void 0!==l?l:e.stars)&&void 0!==t?t:0,u="number"===typeof c?c:Number(c)||0,v=null!==(s=null!==(i=e.text)&&void 0!==i?i:e.content)&&void 0!==s?s:"",m=null!==(r=null!==(a=null!==(o=e.id)&&void 0!==o?o:e.reviewId)&&void 0!==a?a:e._id)&&void 0!==r?r:Math.random().toString(36).slice(2);let h=[];Array.isArray(e.images)?h=e.images.filter(Boolean):Array.isArray(e.photos)?h=e.photos.filter(Boolean):Array.isArray(e.imgUrls)?h=e.imgUrls.filter(Boolean):(e.imgUrl||e.imageUrl||e.photoUrl)&&(h=[e.imgUrl||e.imageUrl||e.photoUrl].filter(Boolean));return{id:m,userName:d,rating:u,text:v,images:Array.from(new Set(h.map(e=>re(e)).filter(Boolean)))}};(0,s.useEffect)(()=>{if(!E||!se)return;let e=!0;return(async()=>{_(!0),P("");try{const{data:n}=await a.Ay.get("/itda/reviews",{params:{storeId:se}}),t=Array.isArray(n)?n:(null===n||void 0===n?void 0:n.items)||(null===n||void 0===n?void 0:n.content)||[];if(!e)return;const l=t.map(ae);L(l),H(new Set)}catch(l){var n,t;if(!e)return;L([]),P((null===l||void 0===l||null===(n=l.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"\ub9ac\ubdf0\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.")}finally{e&&_(!1)}})(),()=>{e=!1}},[E,se]);const oe=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const t=D[e];t&&Array.isArray(t.images)&&0!==t.images.length&&(B(e),q(Math.max(0,Math.min(n,t.images.length-1))),T(!0))},de=()=>T(!1),ce=(0,s.useMemo)(()=>{const e=D[z];return Array.isArray(null===e||void 0===e?void 0:e.images)?e.images:[]},[D,z]),ue=!!le;return k?(0,o.jsxs)("div",{className:"event-detail",children:[(0,o.jsx)("div",{className:"event-floating-actions",children:(0,o.jsx)("button",{type:"button",className:"event-btn ghost",onClick:()=>{se?M(!0):alert("\ub9e4\uc7a5 ID\ub97c \ud655\uc778\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},disabled:!se,title:se?"\uc774 \ub9e4\uc7a5\uc758 \ub9ac\ubdf0 \ubcf4\uae30":"\ub9e4\uc7a5 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4",children:"\ub9e4\uc7a5 \ub9ac\ubdf0 \ubcf4\uae30"})}),(0,o.jsx)("div",{className:"poster-col",children:Z?(0,o.jsx)("img",{src:re(Z),alt:"".concat($," \ud3ec\uc2a4\ud130"),className:"poster-img",onError:e=>{e.currentTarget.style.display="none"}}):(0,o.jsx)("div",{className:"poster-placeholder",children:"\ud3ec\uc2a4\ud130 \uc5c6\uc74c"})}),(0,o.jsxs)("div",{className:"info-col",children:[(0,o.jsx)("div",{className:"title",children:ue?$:ne}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("span",{className:"label",children:"\uae30\uac04"}),(0,o.jsx)("span",{className:"value",children:ue?(0,o.jsxs)(o.Fragment,{children:[ie(W)," ~ ",ie(X)]}):(0,o.jsx)(o.Fragment,{children:"-"})})]}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("span",{className:"label",children:"\ubcf4\uc0c1 \ub0b4\uc6a9"}),(0,o.jsx)("span",{className:"value",children:ue&&Y||"-"})]}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("span",{className:"label",children:"\ubcf4\uc0c1 \uc218\ub7c9"}),(0,o.jsx)("span",{className:"value",children:ue&&null!==ee&&void 0!==ee?ee:"-"})]}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("span",{className:"label",children:"\ub9e4\uc7a5\uba85"}),(0,o.jsx)("span",{className:"value",children:ne})]}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("span",{className:"label",children:"\uc8fc\uc18c"}),(0,o.jsx)("span",{className:"value",children:te})]}),ue?J&&(0,o.jsxs)("div",{className:"desc",children:[(0,o.jsx)("div",{className:"label",children:"\uc124\uba85"}),(0,o.jsx)("div",{className:"value",children:J})]}):(0,o.jsxs)("div",{className:"desc",children:[(0,o.jsx)("div",{className:"label",children:"\uc548\ub0b4"}),(0,o.jsx)("div",{className:"value",children:"\ud604\uc7ac \uac00\ub2a5\ud55c \ubbf8\uc158\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,o.jsx)("div",{className:"actions",children:(0,o.jsx)("button",{type:"button",className:"event-btn primary",onClick:()=>{if(!le)return void alert("\ubbf8\uc158 ID\uac00 \uc5c6\uc5b4 \ub9ac\ubdf0 \ud398\uc774\uc9c0\ub85c \uc774\ub3d9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const e="/review?missionId=".concat(encodeURIComponent(le));R?S(e,{state:{missionId:le,title:$,storeName:ne,storeAddr:te,from:C.pathname+C.search}}):S("".concat(A,"?next=").concat(encodeURIComponent(e)))},disabled:!le,title:le?"\uc774 \ubbf8\uc158\uc5d0 \ub300\ud55c \ub9ac\ubdf0 \uc791\uc131":"\ubbf8\uc158 ID\uac00 \uc5c6\uc5b4 \uc774\ub3d9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",children:"\ub9ac\ubdf0 \uc791\uc131"})})]}),E&&(0,o.jsxs)("div",{className:"rv-modal-backdrop",onClick:()=>M(!1),children:[(0,o.jsxs)("div",{className:"rv-modal",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"rv-modal-head",children:[(0,o.jsx)("strong",{children:"\ub9e4\uc7a5 \ub9ac\ubdf0 \ubcf4\uae30"}),(0,o.jsx)("button",{type:"button",onClick:()=>M(!1),className:"event-btn ghost",children:"\ub2eb\uae30"})]}),(0,o.jsx)("div",{className:"rv-modal-body",children:U&&0===D.length?(0,o.jsx)("div",{style:{color:"#666"},children:"\ub9ac\ubdf0 \ubd88\ub7ec\uc624\ub294 \uc911\u2026"}):F?(0,o.jsx)("div",{style:{color:"#c00"},children:F}):0===D.length?(0,o.jsx)("div",{style:{color:"#666"},children:"\ud45c\uc2dc\ud560 \ub9ac\ubdf0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,o.jsx)("div",{className:"rv-review-list",children:D.map((e,n)=>{var t,l;const s=G.has(e.id);return(0,o.jsxs)("article",{className:"rv-review-card ".concat(null!==(t=e.images)&&void 0!==t&&t.length?"rv-clickable":""),onClick:()=>{var t;return(null===(t=e.images)||void 0===t?void 0:t.length)&&oe(n,0)},title:null!==(l=e.images)&&void 0!==l&&l.length?"\uc774\ubbf8\uc9c0\ub97c \ud06c\uac8c \ubcf4\uae30":void 0,children:[(0,o.jsxs)("div",{className:"rv-review-top",children:[(0,o.jsx)("strong",{className:"rv-review-name",children:e.userName}),(0,o.jsxs)("span",{className:"rv-review-stars","aria-label":"\ubcc4\uc810 ".concat(e.rating,"\uc810"),children:["\u2605".repeat(Math.max(0,Math.floor(e.rating||0))),"\u2606".repeat(Math.max(0,5-Math.floor(e.rating||0)))]})]}),e.text&&(0,o.jsxs)("div",{className:"rv-review-text-wrap ".concat(s?"expanded":"collapsed"),children:[(0,o.jsx)("p",{id:"rv-text-".concat(e.id),className:"rv-review-text ".concat(s?"":"clamp-3"),children:e.text}),!s&&(0,o.jsx)("div",{className:"rv-fade-tail","aria-hidden":!0}),(0,o.jsx)("button",{type:"button",className:"rv-more-btn",onClick:n=>{var t;n.stopPropagation(),t=e.id,H(e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n})},"aria-expanded":s,"aria-controls":"rv-text-".concat(e.id),title:s?"\uc811\uae30":"\uc790\uc138\ud788 \ubcf4\uae30",children:s?"\uc811\uae30":"\uc790\uc138\ud788 \ubcf4\uae30"})]}),Array.isArray(e.images)&&e.images.length>0&&(0,o.jsx)("div",{className:"rv-images-grid",children:e.images.map((e,t)=>(0,o.jsx)("img",{src:e,alt:"\ub9ac\ubdf0 \uc774\ubbf8\uc9c0",className:"rv-image",loading:"lazy",onClick:e=>{e.stopPropagation(),oe(n,t)},onError:e=>{e.currentTarget.style.display="none"}},t))})]},e.id)})})})]}),K&&ce.length>0&&(0,o.jsx)("div",{className:"rv-viewer-backdrop",onClick:de,children:(0,o.jsxs)("div",{className:"rv-viewer",onClick:e=>e.stopPropagation(),children:[(0,o.jsx)("button",{type:"button",className:"rv-viewer-close","aria-label":"\ub2eb\uae30",onClick:de}),(0,o.jsx)("button",{type:"button",className:"rv-viewer-nav left","aria-label":"\uc774\uc804 \uc774\ubbf8\uc9c0",onClick:()=>{ce.length&&q(e=>(e-1+ce.length)%ce.length)},children:"\u2039"}),(0,o.jsx)("img",{src:ce[O],alt:"\ub9ac\ubdf0 \uc774\ubbf8\uc9c0 ".concat(O+1,"/").concat(ce.length),className:"rv-viewer-img",onError:e=>{e.currentTarget.style.display="none"}}),(0,o.jsx)("button",{type:"button",className:"rv-viewer-nav right","aria-label":"\ub2e4\uc74c \uc774\ubbf8\uc9c0",onClick:()=>{ce.length&&q(e=>(e+1)%ce.length)},children:"\u203a"}),(0,o.jsxs)("div",{className:"rv-viewer-count",children:[O+1," / ",ce.length]})]})})]})]}):(0,o.jsx)("div",{className:"event-detail empty",children:(0,o.jsx)("span",{className:"placeholder",children:"\ub9e4\uc7a5\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694."})})}function m(){var e,n,t,i,r,a,d,m,h;const[p,g]=(0,s.useState)(null),[f]=(0,l.ok)(),w=f.get("storeId"),x=w?Number(w):null,N=(0,s.useCallback)(e=>{g(e)},[]),y=null!==(e=null!==(n=null!==(t=null!==(i=null===p||void 0===p||null===(r=p.store)||void 0===r?void 0:r.id)&&void 0!==i?i:null===p||void 0===p||null===(a=p.store)||void 0===a?void 0:a.storeId)&&void 0!==t?t:null===p||void 0===p||null===(d=p.mission)||void 0===d||null===(m=d.store)||void 0===m?void 0:m.id)&&void 0!==n?n:null===p||void 0===p||null===(h=p.mission)||void 0===h?void 0:h.storeId)&&void 0!==e?e:null;return(0,o.jsxs)("div",{className:"itda-eventmap event-page-80",children:[(0,o.jsxs)("div",{className:"map-list-layout",children:[(0,o.jsx)("div",{className:"list-col",children:(0,o.jsx)(u,{storeId:y,address:null===p||void 0===p?void 0:p.address,onPickMission:N})}),(0,o.jsx)("div",{className:"map-col",children:(0,o.jsx)(c,{storeIdToFocus:x,focus:p,onMissionSelect:N})})]}),(0,o.jsx)(v,{selected:p})]})}function h(){return(0,o.jsx)("div",{"data-app":"map",children:(0,o.jsxs)(l.BV,{children:[(0,o.jsx)(l.qh,{index:!0,element:(0,o.jsx)(m,{})}),(0,o.jsx)(l.qh,{path:"*",element:(0,o.jsx)(l.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=836.3e45b590.chunk.js.map