"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[66],{66:(l,e,n)=>{n.r(e),n.d(e,{default:()=>f});var a=n(338),s=n(379),t=n(43),i=n(674),o=n(579);const r=l=>{if(null===l||void 0===l||""===l)return null;const e="string"===typeof l?Number(l):l;return Number.isFinite(e)?e:null},d=l=>({CAFE:"\uce74\ud398",RESTAURANT:"\uc2dd\ub2f9",ETC:"\uae30\ud0c0",0:"\uce74\ud398",1:"\uc2dd\ub2f9",2:"\uae30\ud0c0",0:"\uce74\ud398",1:"\uc2dd\ub2f9",2:"\uae30\ud0c0"}[l]||l||"-"),u=function(){var l,e,n,a,s,t,i,o,d,u,c,p,v,m,g,f,x,h,y,b,N,j,w,S,_,A,C,k,R,T,z,E,I,F;let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const M=null!==(l=null!==(e=null!==(n=null!==(a=L.id)&&void 0!==a?a:L.storeId)&&void 0!==n?n:L.storeID)&&void 0!==e?e:L._id)&&void 0!==l?l:null,B=null!==(s=null!==(t=null!==(i=null!==(o=L.name)&&void 0!==o?o:L.storeName)&&void 0!==i?i:L.title)&&void 0!==t?t:L.shopName)&&void 0!==s?s:"-",D=null!==(d=null!==(u=null!==(c=null!==(p=null!==(v=null!==(m=L.businessNumber)&&void 0!==m?m:L.bizNo)&&void 0!==v?v:L.businessRegistrationNumber)&&void 0!==p?p:L.registrationNumber)&&void 0!==c?c:L.brn)&&void 0!==u?u:L.business_number)&&void 0!==d?d:"-",U=null!==(g=null!==(f=null!==(x=null!==(h=null!==(y=null!==(b=L.address)&&void 0!==b?b:L.roadAddress)&&void 0!==y?y:L.road_address)&&void 0!==h?h:L.jibunAddress)&&void 0!==x?x:L.addr)&&void 0!==f?f:L.fullAddress)&&void 0!==g?g:"-",q=(l=>{if(null===l||void 0===l||""===l)return"";const e=String(l).trim().toUpperCase();if("CAFE"===e)return"0";if("RESTAURANT"===e)return"1";if("ETC"===e)return"2";if(["0","1","2"].includes(e))return e;const n=Number(e);return Number.isInteger(n)&&n>=0&&n<=2?String(n):""})(null!==(N=null!==(j=null!==(w=null!==(S=L.category)&&void 0!==S?S:L.categoryCode)&&void 0!==w?w:L.type)&&void 0!==j?j:L.storeType)&&void 0!==N?N:""),O=r(null!==(_=null!==(A=null!==(C=null!==(k=L.latitude)&&void 0!==k?k:L.lat)&&void 0!==C?C:L.y)&&void 0!==A?A:L.geoLat)&&void 0!==_?_:null===(R=L.location)||void 0===R?void 0:R.lat),P=r(null!==(T=null!==(z=null!==(E=null!==(I=L.longitude)&&void 0!==I?I:L.lng)&&void 0!==E?E:L.x)&&void 0!==z?z:L.geoLng)&&void 0!==T?T:null===(F=L.location)||void 0===F?void 0:F.lng);return{id:null!=M?String(M):null,name:B,businessNumber:D,address:U,category:q,latitude:O,longitude:P,__raw:L}},c=l=>{const e=String(null!==l&&void 0!==l?l:"").replace(/\D/g,"");return 10===e.length?"".concat(e.slice(0,3),"-").concat(e.slice(3,5),"-").concat(e.slice(5)):l||"-"},p=l=>{var e,n;if(!l||"object"!==typeof l)return null;const a=[l.average,l.avg,l.mean,l.rating,l.value,l.score,null===l||void 0===l||null===(e=l.summary)||void 0===e?void 0:e.average,null===l||void 0===l||null===(n=l.summary)||void 0===n?void 0:n.avg].map(r).find(l=>null!=l);return null!=a?a:null},v=l=>{var e;if(!l||"object"!==typeof l)return null;const n=[l.count,l.total,l.size,l.reviewCount,null===l||void 0===l||null===(e=l.summary)||void 0===e?void 0:e.count].map(r).find(l=>null!=l);return null!=n?n:null},m=async l=>{var e,n,a,s,t,o;const r={params:{storeId:l}},[d,u,c]=await Promise.allSettled([i.Ay.get("/summary",r),i.Ay.get("/stats",r),i.Ay.get("/rating",r)]),m="fulfilled"===d.status?null===(e=d.value)||void 0===e?void 0:e.data:null,g="fulfilled"===u.status?null===(n=u.value)||void 0===n?void 0:n.data:null,f="fulfilled"===c.status?null===(a=c.value)||void 0===a?void 0:a.data:null;return{summary:m,stats:g,rating:f,_avg:null!==(s=p(f))&&void 0!==s?s:p(m),_count:null!==(t=null!==(o=v(f))&&void 0!==o?o:v(m))&&void 0!==t?t:v(g)}};function g(){const l=(0,a.Zp)(),[e,n]=(0,t.useState)([]),[r,p]=(0,t.useState)(!0),[v,g]=(0,t.useState)("");(0,t.useEffect)(()=>{let e=!0;return(async()=>{try{p(!0),g("");const{data:l}=await i.Ay.get("/itda/me/stores"),a=(Array.isArray(l)?l:(null===l||void 0===l?void 0:l.items)||[]).map(u),t=new Map;for(const e of a)e.id&&(t.has(e.id)||t.set(e.id,e));const o=Array.from(t.values());if(!e)return;n(o);const r=await Promise.all(o.map(async l=>{try{const e=await m(l.id);return{id:l.id,extras:e}}catch(e){return{id:l.id,extras:{summary:null,stats:null,rating:null,_avg:null,_count:null}}}}));if(!e)return;const d=new Map(r.map(l=>{let{id:e,extras:n}=l;return[e,n]}));n(l=>l.map(l=>(0,s.A)((0,s.A)({},l),{},{__extras:d.get(l.id)||null})))}catch(r){var a,t,o;if(!e)return;if(401===(null===r||void 0===r||null===(a=r.response)||void 0===a?void 0:a.status))return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."),void l("/login");g((null===r||void 0===r||null===(t=r.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message)||"\ub9e4\uc7a5 \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."),n([])}finally{e&&p(!1)}})(),()=>{e=!1}},[l]);const f=()=>{l("/edit")},x=e=>{null!==e&&void 0!==e&&e.id?l("/edit/".concat(e.id),{state:e}):alert("\uc774 \ub9e4\uc7a5\uc740 \uc2dd\ubcc4\uc790\uac00 \uc5c6\uc5b4 \ud3b8\uc9d1\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")};return(0,o.jsxs)("div",{className:"manage-shop-wrap",style:{maxWidth:960,margin:"0 auto",padding:16},children:[(0,o.jsxs)("div",{className:"manage-shop-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,o.jsx)("h2",{style:{margin:0},children:"\ub0b4 \ub9e4\uc7a5 \uad00\ub9ac"}),(0,o.jsx)("button",{className:"btn",onClick:f,style:{padding:"8px 12px",borderRadius:8},children:"\ub9e4\uc7a5 \ucd94\uac00"})]}),r&&(0,o.jsx)("div",{className:"placeholder",style:{padding:12,background:"#f8f9fa",borderRadius:8},children:"\ubd88\ub7ec\uc624\ub294 \uc911..."}),!r&&v&&(0,o.jsx)("div",{className:"placeholder error",style:{padding:12,background:"#fff4f4",border:"1px solid #ffd5d5",borderRadius:8,color:"#c00"},children:v}),!r&&!v&&0===e.length&&(0,o.jsxs)("div",{className:"placeholder",style:{padding:12,background:"#f8f9fa",border:"1px solid #eee",borderRadius:8},children:["\ub4f1\ub85d\ub41c \ub9e4\uc7a5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",(0,o.jsx)("button",{className:"btn",onClick:f,style:{marginLeft:8,padding:"6px 10px",borderRadius:8},children:"\uc9c0\uae08 \ucd94\uac00\ud558\uae30"})]}),(0,o.jsx)("div",{className:"manage-shop-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:12},children:e.map(l=>{var e,n,a;const s=null===(e=l.__extras)||void 0===e?void 0:e._avg,t=null===(n=l.__extras)||void 0===n?void 0:n._count,i=null!=s?"".concat(s.toFixed?s.toFixed(1):s,"\u2605").concat(null!=t?" \xb7 ".concat(t):""):null;return(0,o.jsxs)("div",{className:"shop-card",role:"button",tabIndex:0,onClick:()=>x(l),onKeyDown:e=>"Enter"===e.key&&x(l),style:{background:"#fff",border:"1px solid #eee",borderRadius:12,padding:12,cursor:"pointer",transition:"box-shadow .2s, transform .05s"},onMouseEnter:l=>l.currentTarget.style.boxShadow="0 8px 20px rgba(0,0,0,.08)",onMouseLeave:l=>l.currentTarget.style.boxShadow="none",children:[(0,o.jsxs)("div",{className:"shop-card-title",style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[(0,o.jsx)("span",{className:"shop-name",style:{fontWeight:700,fontSize:16},children:l.name||"-"}),null!=l.category&&(0,o.jsx)("span",{className:"shop-category",style:{fontSize:12,color:"#555",background:"#f1f3f5",borderRadius:999,padding:"2px 8px"},children:d(l.category)}),i&&(0,o.jsx)("span",{className:"shop-rating-chip",title:"\ud3c9\uade0 \ud3c9\uc810 \xb7 \ub9ac\ubdf0 \uc218",style:{marginLeft:"auto",fontSize:12,color:"#333",background:"#fff7e6",border:"1px solid #ffe0a3",borderRadius:999,padding:"2px 8px"},children:i})]}),(0,o.jsxs)("div",{className:"shop-meta",style:{display:"flex",gap:8,fontSize:14,margin:"4px 0"},children:[(0,o.jsx)("span",{className:"label",style:{width:88,color:"#777",flex:"0 0 88px"},children:"\uc0ac\uc5c5\uc790\ubc88\ud638"}),(0,o.jsx)("span",{className:"value",style:{color:"#333"},children:c(l.businessNumber)})]}),(0,o.jsxs)("div",{className:"shop-meta",style:{display:"flex",gap:8,fontSize:14,margin:"4px 0"},children:[(0,o.jsx)("span",{className:"label",style:{width:88,color:"#777",flex:"0 0 88px"},children:"\uc8fc\uc18c"}),(0,o.jsx)("span",{className:"value",style:{color:"#333",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:l.address||"",children:l.address||"-"})]}),(0,o.jsxs)("div",{className:"shop-meta",style:{display:"flex",gap:8,fontSize:14,margin:"4px 0"},children:[(0,o.jsx)("span",{className:"label",style:{width:88,color:"#777",flex:"0 0 88px"},children:"\uc88c\ud45c"}),(0,o.jsx)("span",{className:"value",style:{color:"#333"},children:null!=l.latitude&&null!=l.longitude?"".concat(l.latitude,", ").concat(l.longitude):"-"})]}),(null===(a=l.__extras)||void 0===a?void 0:a.stats)&&(0,o.jsxs)("div",{className:"shop-meta",style:{display:"flex",gap:8,fontSize:13,marginTop:6,color:"#555"},children:[(0,o.jsx)("span",{className:"label",style:{width:88,color:"#777",flex:"0 0 88px"},children:"\ud1b5\uacc4"}),(0,o.jsx)("span",{className:"value",style:{color:"#333"},children:Object.entries(l.__extras.stats).slice(0,3).map(l=>{let[e,n]=l;return"".concat(e,": ").concat("number"===typeof n?n:String(n))}).join(" \xb7 ")})]})]},l.id)})})]})}function f(){return(0,o.jsx)("div",{"data-app":"manage-shop",children:(0,o.jsxs)(a.BV,{children:[(0,o.jsx)(a.qh,{index:!0,element:(0,o.jsx)(g,{})}),(0,o.jsx)(a.qh,{path:"*",element:(0,o.jsx)(a.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=66.2eacf692.chunk.js.map