"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4],{261:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var l=n(43),i=n(338),a=n(764),r=(n(15),n(646)),d=n(176),s=n(358),o=n(465),u=n(579);(0,a.E)("ko",r.ko),(0,a.YC)("ko");const c=e=>String(e).padStart(2,"0");const v=function(){const[e,t]=(0,l.useState)(null),[n,i]=(0,l.useState)(null),r=(0,d.o)(new Date),v=new Date,p=e=>e instanceof Date&&!isNaN(null===e||void 0===e?void 0:e.valueOf()),m=(e,t)=>{const n=document.getElementById(e);n&&(n.value=null!==t&&void 0!==t?t:"")},h=(e,t)=>{var n;m("".concat(e,"-at"),(n=t)instanceof Date&&!isNaN(null===n||void 0===n?void 0:n.valueOf())?n.getFullYear()+"-"+c(n.getMonth()+1)+"-"+c(n.getDate())+"T"+c(n.getHours())+":"+c(n.getMinutes())+":"+c(n.getSeconds())+".000":""),m(e,(e=>e instanceof Date&&!isNaN(null===e||void 0===e?void 0:e.valueOf())?"".concat(e.getFullYear(),"-").concat(c(e.getMonth()+1),"-").concat(c(e.getDate())," ").concat(c(e.getHours()),":").concat(c(e.getMinutes())):"")(t))},g=e||r,x=p(e)&&(0,o.r)(e,r),f=x?v:void 0,j=x?new Date(1970,0,1,23,59,59,999):void 0,y=p(n)&&p(e)&&(0,o.r)(n,e),b=p(n)&&(0,o.r)(n,r);let N,w;return y?(N=e,w=new Date(1970,0,1,23,59,59,999)):b?(N=v,w=new Date(1970,0,1,23,59,59,999)):(N=void 0,w=void 0),(0,u.jsxs)("div",{className:"global-fix",children:[(0,u.jsx)("input",{type:"hidden",id:"event-start-at"}),(0,u.jsx)("input",{type:"hidden",id:"event-end-at"}),(0,u.jsx)("input",{type:"hidden",id:"event-start"}),(0,u.jsx)("input",{type:"hidden",id:"event-end"}),(0,u.jsxs)("div",{className:"date-row",children:[(0,u.jsx)(a.Ay,{className:"date-input",placeholderText:"Select Start Date",locale:"ko",showTimeSelect:!0,timeIntervals:1,dateFormat:"yyyy/MM/dd HH:mm",selected:e,selectsStart:!0,startDate:e,endDate:n,minDate:r,minTime:f,maxTime:j,onChange:e=>{if(!p(e))return t(null),void h("event-start",null);const l=(0,s.Y)(e,r)?r:e;n&&(0,s.Y)(n,l)&&(i(l),h("event-end",l)),t(l),h("event-start",l)},withPortal:!0,popperPlacement:"bottom-start","aria-label":"\uc2dc\uc791 \ub0a0\uc9dc"}),"\xa0~\xa0",(0,u.jsx)(a.Ay,{className:"date-input",placeholderText:"Select End Date",locale:"ko",showTimeSelect:!0,timeIntervals:1,dateFormat:"yyyy/MM/dd HH:mm",selected:n,selectsEnd:!0,startDate:e,endDate:n,minDate:g,minTime:N,maxTime:w,onChange:t=>{if(!p(t))return i(null),void h("event-end",null);const n=e||r,l=(0,s.Y)(t,n)?n:t;i(l),h("event-end",l)},withPortal:!0,popperPlacement:"bottom-start","aria-label":"\uc885\ub8cc \ub0a0\uc9dc"})]})]})};const p=function(){const[e,t]=(0,l.useState)("");return(0,u.jsxs)("div",{children:[(0,u.jsx)("input",{type:"hidden",id:"event-reward-count",value:e,readOnly:!0}),(0,u.jsx)("input",{type:"number",className:"reward-input ".concat(""===e?"is-placeholder":""),placeholder:"\ubcf4\uc0c1 \uc218\ub7c9",value:e,onChange:e=>{const n=e.target.value;if(""===n)return void t("");const l=Math.max(0,Math.floor(Number(n)));t(String(l))},min:0,step:1,inputMode:"numeric",pattern:"[0-9]*"})]})};var m=n(379),h=n(674);const g=function(e){let{onSelect:t}=e;const[n,i]=(0,l.useState)(""),[a,r]=(0,l.useState)([]),[d,s]=(0,l.useState)(!1),[o,c]=(0,l.useState)("");(0,l.useEffect)(()=>{let e=!0;return(async()=>{s(!0),c("");try{const{data:t}=await h.Ay.get("/itda/me/stores"),n=(Array.isArray(t)?t:(null===t||void 0===t?void 0:t.items)||[]).map(e=>{var t,n,l,i,a,r,d,s,o,u,c,v,p,h,g;const x=null!==(t=null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:null===e||void 0===e?void 0:e.storeId)&&void 0!==t?t:null===e||void 0===e||null===(l=e.store)||void 0===l?void 0:l.id,f=null!==(i=null!==(a=null!==(r=null!==(d=null!==(s=null===e||void 0===e?void 0:e.name)&&void 0!==s?s:null===e||void 0===e?void 0:e.storeName)&&void 0!==d?d:null===e||void 0===e||null===(o=e.store)||void 0===o?void 0:o.name)&&void 0!==r?r:null===e||void 0===e?void 0:e.shopName)&&void 0!==a?a:null===e||void 0===e?void 0:e.title)&&void 0!==i?i:null!=x?"\ub9e4\uc7a5#".concat(x):"\uc774\ub984 \uc5c6\uc74c",j=null!==(u=null!==(c=null===e||void 0===e?void 0:e.latitude)&&void 0!==c?c:null===e||void 0===e?void 0:e.lat)&&void 0!==u?u:null===e||void 0===e||null===(v=e.store)||void 0===v?void 0:v.latitude,y=null!==(p=null!==(h=null===e||void 0===e?void 0:e.longitude)&&void 0!==h?h:null===e||void 0===e?void 0:e.lng)&&void 0!==p?p:null===e||void 0===e||null===(g=e.store)||void 0===g?void 0:g.longitude,b="string"===typeof j?Number(j):j,N="string"===typeof y?Number(y):y;return(0,m.A)((0,m.A)({},e),{},{id:x,name:f,latitude:b,longitude:N})});e&&r(n)}catch(t){e&&(c("\ub9e4\uc7a5 \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."),r([]))}finally{e&&s(!1)}})(),()=>{e=!1}},[]);const v=(0,l.useMemo)(()=>a.find(e=>String(e.id)===String(n)),[a,n]);(0,l.useEffect)(()=>{const e=document.getElementById("event-store-id"),n=document.getElementById("event-shop"),l=document.getElementById("event-lat"),i=document.getElementById("event-lng"),a=document.getElementById("event-address");var r,d,s;v?(e&&(e.value=String(v.id)),n&&(n.value=null!==(r=v.name)&&void 0!==r?r:""),l&&(l.value=null!==(d=v.latitude)&&void 0!==d?d:""),i&&(i.value=null!==(s=v.longitude)&&void 0!==s?s:""),a&&(a.value=""),"function"===typeof t&&t({id:v.id,name:v.name,latitude:v.latitude,longitude:v.longitude,category:v.category,description:v.description})):(e&&(e.value=""),n&&(n.value=""),l&&(l.value=""),i&&(i.value=""),a&&(a.value=""))},[v,t]);const p=a.length>0;return(0,u.jsxs)("div",{className:"select-shop-wrap",children:[(0,u.jsx)("input",{type:"hidden",id:"event-store-id"}),(0,u.jsx)("input",{type:"hidden",id:"event-shop"}),(0,u.jsx)("input",{type:"hidden",id:"event-lat"}),(0,u.jsx)("input",{type:"hidden",id:"event-lng"}),(0,u.jsx)("input",{type:"hidden",id:"event-address"}),(0,u.jsxs)("select",{className:"select-input ".concat(""===n?"is-placeholder":""),value:n,onChange:e=>{i(e.target.value)},disabled:d,title:d?"\ubd88\ub7ec\uc624\ub294 \uc911...":"\ub9e4\uc7a5 \uc120\ud0dd",children:[(0,u.jsx)("option",{value:"",disabled:!0,hidden:!0,children:"\ub9e4\uc7a5 \uc120\ud0dd"}),d&&(0,u.jsx)("option",{value:"",disabled:!0,children:"\ubd88\ub7ec\uc624\ub294 \uc911..."}),!d&&o&&(0,u.jsx)("option",{value:"",disabled:!0,children:"\ub9e4\uc7a5 \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."}),!d&&!o&&!p&&(0,u.jsx)("option",{value:"",disabled:!0,children:"\ub9e4\uc7a5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),!d&&!o&&p&&a.map(e=>(0,u.jsx)("option",{value:String(e.id),children:e.name},String(e.id)))]})]})};function x(e){let{onChange:t,maxSizeMB:n=5}=e;const i=(0,l.useRef)(null),[a,r]=(0,l.useState)(null),[d,s]=(0,l.useState)(""),[o,c]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!a)return void s("");const e=URL.createObjectURL(a);return s(e),()=>URL.revokeObjectURL(e)},[a]),(0,l.useEffect)(()=>{if(!o)return;const e=e=>"Escape"===e.key&&c(!1);return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[o]);return(0,u.jsxs)("div",{className:"poster-upload",children:[(0,u.jsxs)("label",{className:"btn poster-btn",title:"\uc774\ubca4\ud2b8 \ud3ec\uc2a4\ud130 \uc5c5\ub85c\ub4dc",children:["\ud3ec\uc2a4\ud130 \uc5c5\ub85c\ub4dc",(0,u.jsx)("input",{ref:i,type:"file",accept:"image/*",onChange:e=>{var l;const a=null===(l=e.target.files)||void 0===l?void 0:l[0];if(!a)return;if(!a.type.startsWith("image/"))return alert("\uc774\ubbf8\uc9c0 \ud30c\uc77c\ub9cc \uc5c5\ub85c\ub4dc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),i.current&&(i.current.value=""),r(null),void(null===t||void 0===t||t(null));const d=1024*n*1024;if(a.size>d)return alert("\uc774\ubbf8\uc9c0 \ud06c\uae30\ub294 ".concat(n,"MB \uc774\ud558\uc5ec\uc57c \ud569\ub2c8\ub2e4.")),i.current&&(i.current.value=""),r(null),void(null===t||void 0===t||t(null));r(a),null===t||void 0===t||t(a)},style:{display:"none"}})]}),(0,u.jsx)("button",{type:"button",className:"btn poster-btn",onClick:()=>c(!0),disabled:!a,title:a?"\ubbf8\ub9ac\ubcf4\uae30":"\uc774\ubbf8\uc9c0\ub97c \uba3c\uc800 \uc120\ud0dd\ud558\uc138\uc694",children:"\ubbf8\ub9ac\ubcf4\uae30"}),(0,u.jsx)("button",{type:"button",className:"btn poster-btn",onClick:()=>{r(null),s(""),i.current&&(i.current.value=""),null===t||void 0===t||t(null)},disabled:!a,title:a?"\uc120\ud0dd\ud55c \uc774\ubbf8\uc9c0 \uc81c\uac70":"\uc81c\uac70\ud560 \uc774\ubbf8\uc9c0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4",children:"\uc81c\uac70"}),a&&(0,u.jsx)("div",{className:"poster-filename",title:a.name,children:a.name}),o&&(0,u.jsxs)("div",{className:"poster-float",role:"dialog","aria-modal":"false","aria-label":"\ud3ec\uc2a4\ud130 \ubbf8\ub9ac\ubcf4\uae30",children:[(0,u.jsxs)("div",{className:"poster-float-header",children:[(0,u.jsx)("strong",{children:"\ud3ec\uc2a4\ud130 \ubbf8\ub9ac\ubcf4\uae30"}),(0,u.jsx)("button",{type:"button",className:"poster-close",onClick:()=>c(!1),"aria-label":"\ub2eb\uae30"})]}),(0,u.jsx)("div",{className:"poster-float-body",children:d?(0,u.jsx)("img",{src:d,alt:"\uc774\ubca4\ud2b8 \ud3ec\uc2a4\ud130 \ubbf8\ub9ac\ubcf4\uae30",className:"poster-preview-img"}):(0,u.jsx)("p",{children:"\uc120\ud0dd\ub41c \uc774\ubbf8\uc9c0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})})]})]})}const f=function(){const[e,t]=(0,l.useState)("");return(0,u.jsx)("div",{children:(0,u.jsx)("input",{id:"event-title",className:"title-input ".concat(""===e?"is-placeholder":""),type:"text",value:e,placeholder:"\ub9ac\ubdf0 \ubbf8\uc158 \uc81c\ubaa9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",onChange:e=>{t(e.target.value)}})})};function j(){const[e,t]=(0,l.useState)("");return(0,u.jsxs)("div",{children:[(0,u.jsx)("input",{type:"hidden",id:"event-desc",value:e,readOnly:!0}),(0,u.jsx)("textarea",{className:"content-input ".concat(""===e?"is-placeholder":""),placeholder:"\uc774\ubca4\ud2b8 \uc124\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",value:e,onChange:e=>t(e.target.value),rows:10})]})}const y={withCredentials:!0},b=e=>String(e).padStart(2,"0"),N=e=>{if(!e)return null;if(e instanceof Date)return isNaN(e)?null:e;let t=String(e).trim();if(!t)return null;t=t.replace(/\//g,"-");let n=t.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\.(\d{3})$/);if(n){const[,e,t,l,i,a,r,d]=n.map(Number);return new Date(e,t-1,l,i,a,r,d)}if(n=t.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?$/),n){const[,e,t,l,i,a,r]=n.map(Number);return new Date(e,t-1,l,i,a,r||0,0)}return null},w=e=>e instanceof Date&&!isNaN(null===e||void 0===e?void 0:e.valueOf())?e.getFullYear()+"-"+b(e.getMonth()+1)+"-"+b(e.getDate())+"T"+b(e.getHours())+":"+b(e.getMinutes())+":"+b(e.getSeconds())+".000":null,S=e=>{const t=document.getElementById(e);return t?String(t.value||"").trim():""},C=e=>{if(void 0===e||null===e)return null;const t=String(e).trim();if(""===t)return null;const n=Number(t);return Number.isFinite(n)?Math.max(0,Math.floor(n)):null};function D(e){let{collect:t,posterFile:n}=e;const a=(0,i.Zp)(),[r,d]=(0,l.useState)(!1);return(0,u.jsx)("button",{type:"button",onClick:async()=>{var e,l,i,s,o;if(r)return;const u=null!==(e=null===t||void 0===t?void 0:t())&&void 0!==e?e:null;if(!u||"object"!==typeof u)return void alert("\ud3fc \ub370\uc774\ud130\ub97c \uc218\uc9d1\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const c=String(null!==(l=u.title)&&void 0!==l?l:"").trim(),v=String((null!==(i=u.description)&&void 0!==i?i:S("event-desc"))||"").trim(),p=Number(u.storeId||0);if(!c)return alert("\uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694.");if(!p)return alert("\ub9e4\uc7a5\uc744 \uc120\ud0dd\ud558\uc138\uc694.");const m=String((null!==(s=u.rewardContent)&&void 0!==s?s:S("event-reward-content"))||"").trim(),g=u.startAt||S("event-start-at")||S("event-start"),x=u.endAt||S("event-end-at")||S("event-end"),f=w(N(g)),j=w(N(x));if(!f||!j)return void alert("\uc2dc\uc791/\uc885\ub8cc \uc77c\uc2dc\ub97c \uc120\ud0dd\ud558\uc138\uc694.");const b=null!==(o=C(u.rewardCount))&&void 0!==o?o:C(S("event-reward-count"));try{d(!0);const e={title:c,description:v,startAt:f,endAt:j,storeId:p,rewardContent:m};null!==b&&(e.rewardCount=b);const t=new FormData,l=new Blob([JSON.stringify(e)],{type:"application/json"});t.append("request",l,"request.json"),n&&t.append("image",n,n.name||"image"),await h.Ay.post("/itda/missions",t,y),alert("\ubbf8\uc158\uc774 \ub4f1\ub85d\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),a("/map")}catch(M){var D,E;const e=(null===M||void 0===M||null===(D=M.response)||void 0===D||null===(E=D.data)||void 0===E?void 0:E.message)||(null===M||void 0===M?void 0:M.message)||"\ub4f1\ub85d \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.";alert(e)}finally{d(!1)}},disabled:r,className:"re-btn re-btn--primary re-btn--lg re-btn--80vw re-btn--center","data-pending":r?"true":"false","aria-busy":r?"true":"false",children:r?"\ub4f1\ub85d \uc911...":"\ub9ac\ubdf0\uc774\ubca4\ud2b8 \ub4f1\ub85d"})}function E(e){let{disabled:t=!1,required:n=!1,exampleText:i="\uc608\uc2dc) \uc544\uba54\ub9ac\uce74\ub178 1\uc794"}=e;const[a,r]=(0,l.useState)("");return(0,u.jsxs)("label",{children:[(0,u.jsx)("input",{type:"hidden",id:"event-reward-content",value:a,readOnly:!0}),(0,u.jsx)("input",{type:"text",className:"reward-content-input",placeholder:"\ubcf4\uc0c1 \ub0b4\uc6a9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",value:a,onChange:e=>r(e.target.value),title:i,disabled:t,required:n})]})}const M=function(){const[e,t]=(0,l.useState)(null);return(0,u.jsxs)("div",{children:[(0,u.jsx)(f,{})," ",(0,u.jsx)("h1",{}),(0,u.jsx)("div",{className:"app-row2",children:(0,u.jsxs)("div",{className:"app-row",children:[(0,u.jsx)(v,{}),"       ",(0,u.jsx)(p,{}),"    ",(0,u.jsx)(E,{}),"  "]})}),(0,u.jsx)("h1",{}),(0,u.jsx)("div",{className:"app-row2",children:(0,u.jsxs)("div",{className:"app-row",children:[(0,u.jsx)(g,{}),(0,u.jsx)(x,{onChange:t}),"  "]})}),(0,u.jsx)("h1",{}),(0,u.jsx)(j,{}),"  ",(0,u.jsx)("h1",{}),(0,u.jsx)(D,{collect:()=>{const e=e=>{var t,n;return(null!==(t=null===(n=document.getElementById(e))||void 0===n?void 0:n.value)&&void 0!==t?t:"").trim()},t=e=>e?new Date(e).toISOString().slice(0,19):"",n=e=>{const t=parseFloat(e);return Number.isFinite(t)?t:null},l=e("event-start"),i=e("event-end");return{title:e("event-title"),description:e("event-desc"),storeId:Number(e("event-store-id")||0),shopName:e("event-shop"),address:e("event-address"),lat:n(e("event-lat")),lng:n(e("event-lng")),startAt:t(l),endAt:t(i),rewardCount:(e=>{const t=parseInt(e,10);return Number.isFinite(t)?t:null})(e("event-reward-count")),rewardContent:e("event-reward-content")}},posterFile:e})," "]})};function k(){return(0,u.jsx)("div",{"data-app":"createreviewevent",children:(0,u.jsxs)(i.BV,{children:[(0,u.jsx)(i.qh,{index:!0,element:(0,u.jsx)(M,{})}),(0,u.jsx)(i.qh,{path:"*",element:(0,u.jsx)(i.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=4.1b77cde8.chunk.js.map