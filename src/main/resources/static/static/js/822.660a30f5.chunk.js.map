{"version":3,"file":"static/js/822.660a30f5.chunk.js","mappings":"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","sources":["features/userMyPage/UserMyPage.js","features/userMyPage/index.js"],"sourcesContent":["// src/pages/MyPage.jsx\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { useOutletContext } from \"react-router-dom\";\r\nimport api from \"../../api\";\r\nimport \"./UserMyPage.css\";\r\n\r\nconst FILTERS = [\"ALL\", \"ISSUED\", \"USED\", \"EXPIRED\"];\r\nconst WITH_CREDENTIALS = { withCredentials: true };\r\n\r\nexport default function MyPage() {\r\n  const outletCtx = useOutletContext();\r\n  const initialUser = outletCtx?.user?.id ? outletCtx.user : null;\r\n\r\n  const [user, setUser] = useState(initialUser);\r\n  const [loadingUser, setLoadingUser] = useState(!initialUser);\r\n\r\n  const [reviews, setReviews] = useState([]);\r\n  const [loadingReviews, setLoadingReviews] = useState(false);\r\n\r\n  const [vouchers, setVouchers] = useState([]);\r\n  const [loadingVouchers, setLoadingVouchers] = useState(false);\r\n  const [voucherFilter, setVoucherFilter] = useState(\"ISSUED\");\r\n\r\n  const email = user?.email || \"\";\r\n  const initial = (user?.name || user?.email || \"U\").toString().slice(0, 1).toUpperCase();\r\n  const displayName = user?.username || user?.name || user?.email || \"사용자\";\r\n\r\n  // 유저 확보\r\n  useEffect(() => {\r\n    let alive = true;\r\n    (async () => {\r\n      try {\r\n        if (outletCtx?.user?.id) {\r\n          if (alive) {\r\n            setUser(outletCtx.user);\r\n            setLoadingUser(false);\r\n          }\r\n          return;\r\n        }\r\n        setLoadingUser(true);\r\n        const { data } = await api.get(\"/itda/me\", WITH_CREDENTIALS);\r\n        if (alive) setUser(data?.id ? data : null);\r\n      } catch {\r\n        if (alive) setUser(null);\r\n      } finally {\r\n        if (alive) setLoadingUser(false);\r\n      }\r\n    })();\r\n    return () => { alive = false; };\r\n  }, [outletCtx?.user?.id]);\r\n\r\n  // 리뷰 로드\r\n  useEffect(() => {\r\n    if (!user?.id) return;\r\n    let alive = true;\r\n    (async () => {\r\n      try {\r\n        setLoadingReviews(true);\r\n        const { data } = await api.get(\"/itda/reviews\", {\r\n          params: { userId: user.id },\r\n          ...WITH_CREDENTIALS,\r\n        });\r\n        if (alive) setReviews(Array.isArray(data) ? data : data?.items || []);\r\n      } catch {\r\n        if (alive) setReviews([]);\r\n      } finally {\r\n        if (alive) setLoadingReviews(false);\r\n      }\r\n    })();\r\n    return () => { alive = false; };\r\n  }, [user?.id]);\r\n\r\n  // 날짜 포맷 (문자열/ISO/오프셋/epoch 모두 지원)\r\n  const fmtDate = (d) => {\r\n    if (d === null || d === undefined || d === \"\") return \"-\";\r\n    if (typeof d === \"number\") {\r\n      const ms = d > 1e12 ? d : d * 1000;\r\n      const dt = new Date(ms);\r\n      return isNaN(dt.getTime()) ? \"-\" : dt.toISOString().slice(0, 10);\r\n    }\r\n    const s = String(d).trim();\r\n    if (!s) return \"-\";\r\n    const dt = new Date(s);\r\n    return isNaN(dt.getTime()) ? s.slice(0, 10) : dt.toISOString().slice(0, 10);\r\n  };\r\n\r\n  // 바우처 로드\r\n  const fetchVouchers = async (filter) => {\r\n    if (!user?.id) return;\r\n    setLoadingVouchers(true);\r\n\r\n    const normalize = (list, assumedFilter) =>\r\n      list.map((v) => {\r\n        // ID 통일\r\n        const id =\r\n          v.id ?? v.voucherId ?? v.voucherID ?? v.uuid ?? v.code ?? v._id;\r\n\r\n        // 상태 통일\r\n        const rawStatus = (v.vstatus || v.status || assumedFilter || \"ISSUED\")\r\n          .toString()\r\n          .toUpperCase();\r\n        const status = assumedFilter === \"ALL\" ? rawStatus : rawStatus;\r\n\r\n        // 사용처(매장명)\r\n        const storeName =\r\n          v.storeName ||\r\n          v.store?.name ||\r\n          v.mission?.storeName ||\r\n          v.mission?.store?.name ||\r\n          \"\";\r\n\r\n        // 🔑 보상명(제목) — rewardContent를 최우선 사용\r\n        const rewardTitle =\r\n          v.rewardContent ||                    // ✅ 아이스 아메리카노 1잔\r\n          v.rewardName;\r\n\r\n        // 최종 제목 텍스트\r\n        const pureTitle = rewardTitle || v.title || v.name;\r\n\r\n        // 화면 표시용 제목: [매장명]보상내용  (중간 공백 없이)\r\n        const displayTitle = `${storeName ? `[${storeName}] ` : \"\"}${pureTitle}`;\r\n\r\n        // 사용기간(시작/끝) — 다양한 키 흡수\r\n        const start =\r\n          v.validFrom ??\r\n          v.startAt ??\r\n          v.start_date ??\r\n          v.startDate ??\r\n          v.issuedAt ??\r\n          null;\r\n\r\n        const end =\r\n          v.validTo ??\r\n          v.endAt ??\r\n          v.end_date ??\r\n          v.endDate ??\r\n          v.expireAt ??\r\n          v.expirationDate ??\r\n          null;\r\n\r\n        return {\r\n          ...v,\r\n          id,\r\n          status,\r\n          storeName,\r\n          title: displayTitle, // ✅ 바로 표시용으로 저장\r\n          start,\r\n          end,\r\n        };\r\n      });\r\n\r\n    try {\r\n      const effective = filter || voucherFilter || \"ISSUED\";\r\n      if (effective === \"ALL\") {\r\n        const statusList = [\"ISSUED\", \"USED\", \"EXPIRED\"];\r\n        const results = await Promise.all(\r\n          statusList.map((f) =>\r\n            api\r\n              .get(\"/itda/me/vouchers\", { params: { filter: f }, ...WITH_CREDENTIALS })\r\n              .then(({ data }) => (Array.isArray(data) ? data : data?.items || []))\r\n              .catch(() => [])\r\n          )\r\n        );\r\n        const merged = [...results[0], ...results[1], ...results[2]];\r\n        const seen = new Set();\r\n        const deduped = merged.filter((v) => {\r\n          const vid = v.id ?? v.voucherId ?? v.uuid ?? v.code ?? v._id;\r\n          if (seen.has(vid)) return false;\r\n          seen.add(vid);\r\n          return true;\r\n        });\r\n        setVouchers(normalize(deduped, \"ALL\"));\r\n      } else {\r\n        const { data } = await api.get(\"/itda/me/vouchers\", {\r\n          params: { filter: effective },\r\n          ...WITH_CREDENTIALS,\r\n        });\r\n        const list = Array.isArray(data) ? data : data?.items || [];\r\n        setVouchers(normalize(list, effective));\r\n      }\r\n    } catch {\r\n      setVouchers([]);\r\n    } finally {\r\n      setLoadingVouchers(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!user?.id) return;\r\n    fetchVouchers(voucherFilter);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user?.id, voucherFilter]);\r\n\r\n  const statusMeta = useMemo(\r\n    () => ({\r\n      ALL: { label: \"전체\", chip: \"\" },\r\n      ISSUED: { label: \"발급\", chip: \"success\" },\r\n      USED: { label: \"사용\", chip: \"warn\" },\r\n      EXPIRED: { label: \"만료\", chip: \"muted\" },\r\n    }),\r\n    []\r\n  );\r\n\r\n  const reviewStatusMeta = useMemo(\r\n    () => ({\r\n      APPROVED: { label: \"승인됨\", chip: \"success\" },\r\n      PENDING: { label: \"대기중\", chip: \"warn\" },\r\n      REJECTED: { label: \"비승인\", chip: \"muted\" },\r\n    }),\r\n    []\r\n  );\r\n\r\n  const handleUseVoucher = async (voucherId) => {\r\n    if (!voucherId) return;\r\n    if (!window.confirm(\"이 바우처를 사용 처리하시겠습니까?\")) return;\r\n\r\n    try {\r\n      await api.patch(`/itda/me/vouchers/${voucherId}/use`, null, WITH_CREDENTIALS);\r\n      fetchVouchers(voucherFilter);\r\n    } catch (e) {\r\n      const msg =\r\n        e?.response?.data?.message || e?.message || \"사용 처리 중 오류가 발생했습니다.\";\r\n      alert(msg);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"mypage-root\">\r\n      {/* 헤더 */}\r\n      <header className=\"mypage-header\">\r\n        <div className=\"logo-text\">리뷰어 마이페이지</div>\r\n\r\n        <div className=\"mypage-user\">\r\n          <div className=\"mypage-user-meta\">\r\n            <span className=\"mypage-user-name\">{displayName}</span>\r\n            {email && <span className=\"mypage-user-mail\">{email}</span>}\r\n          </div>\r\n          <div className=\"mypage-avatar\" aria-hidden>\r\n            {initial}\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* 메인 */}\r\n      <main className=\"mypage-main\">\r\n        {/* 리뷰 섹션 */}\r\n        <section className=\"mypage-section\" aria-label=\"리뷰 목록\">\r\n          <div className=\"mypage-section-head\">\r\n            <h2 className=\"mypage-section-title\">리뷰 목록</h2>\r\n          </div>\r\n\r\n          <div className=\"mypage-list\">\r\n            {loadingReviews ? (\r\n              <>\r\n                <div className=\"mypage-card mypage-skeleton\" />\r\n                <div className=\"mypage-card mypage-skeleton\" />\r\n              </>\r\n            ) : reviews.length === 0 ? (\r\n              <div className=\"mypage-empty\">아직 작성한 리뷰가 없습니다.</div>\r\n            ) : (\r\n              reviews.map((review) => {\r\n                const statusKey =\r\n                  (review.status || \"\").toString().toUpperCase();\r\n                const statusInfo =\r\n                  reviewStatusMeta[statusKey] || reviewStatusMeta.PENDING;\r\n\r\n                return (\r\n                  <article key={review.id} className=\"mypage-card\">\r\n                    {/* 가게 정보 */}\r\n                    <div className=\"mypage-store\">\r\n                      <div className=\"mypage-store-thumb\" aria-hidden>\r\n                        📷\r\n                      </div>\r\n                      <div className=\"mypage-store-info\">\r\n                        <div className=\"mypage-store-name\">\r\n                          {review.storeName}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* 리뷰 내용 */}\r\n                    <div className=\"mypage-review\">\r\n                      <div className=\"mypage-avatar sm\" aria-hidden>\r\n                        👤\r\n                      </div>\r\n                      <div className=\"mypage-review-body\">\r\n                        <div className=\"mypage-review-meta\">\r\n                          <span className=\"mypage-review-author\">\r\n                            {displayName}\r\n                          </span>\r\n                          {/* 상태 칩 */}\r\n                          <span className={`mypage-chip ${statusInfo.chip}`}>\r\n                            {statusInfo.label}\r\n                          </span>\r\n                        </div>\r\n                        {review.content && (\r\n                          <p className=\"mypage-review-text\">\r\n                            {review.content}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </article>\r\n                );\r\n              })\r\n            )}\r\n          </div>\r\n        </section>\r\n\r\n        {/* 바우처 섹션 */}\r\n        <section className=\"mypage-section\" aria-label=\"바우처 목록\">\r\n          <div className=\"mypage-section-head\">\r\n            <h2 className=\"mypage-section-title\">바우처 목록</h2>\r\n\r\n            {/* 탭 */}\r\n            <div className=\"mypage-tabs\" role=\"tablist\" aria-label=\"바우처 상태 필터\">\r\n              {FILTERS.map((key) => (\r\n                <button\r\n                  key={key}\r\n                  type=\"button\"\r\n                  className={`mypage-tab ${voucherFilter === key ? \"active\" : \"\"}`}\r\n                  role=\"tab\"\r\n                  aria-selected={voucherFilter === key}\r\n                  onClick={() => setVoucherFilter(key)}\r\n                >\r\n                  {statusMeta[key]?.label || key}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mypage-list\">\r\n            {loadingVouchers ? (\r\n              <>\r\n                <div className=\"mypage-card mypage-skeleton\" />\r\n                <div className=\"mypage-card mypage-skeleton\" />\r\n              </>\r\n            ) : vouchers.length === 0 ? (\r\n              <div className=\"mypage-empty\">해당 상태의 바우처가 없습니다.</div>\r\n            ) : (\r\n              vouchers.map((v) => {\r\n                const meta = statusMeta[v.status] || statusMeta.ISSUED;\r\n                return (\r\n                  <article key={v.id} className=\"mypage-card mypage-reward\">\r\n                    {/* 왼쪽 */}\r\n                    <div className=\"mypage-reward-left\">\r\n                      <div className={`mypage-chip ${meta.chip}`}>\r\n                        {statusMeta[v.status]?.label ?? meta.label}\r\n                      </div>\r\n\r\n                      <div className=\"mypage-reward-body\">\r\n                        {/* 제목: [매장명]보상내용 */}\r\n                        <div className=\"mypage-reward-title\">{v.title}</div>\r\n\r\n                        <div className=\"mypage-reward-period\">\r\n                          {v.start || v.end ? (\r\n                            <>사용기간: {fmtDate(v.start)} ~ {fmtDate(v.end)}</>\r\n                          ) : (\r\n                            <>사용기간: -</>\r\n                          )}\r\n                          <span className=\"mypage-reward-place\">\r\n                            {\" \"}\r\n                            · 사용처: {v.storeName || \"-\"}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* 발급 상태에서만 버튼 */}\r\n                    {v.status === \"ISSUED\" && (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"mypage-btn use\"\r\n                        onClick={() => handleUseVoucher(v.id)}\r\n                        title=\"바우처 사용 처리\"\r\n                      >\r\n                        사용 처리\r\n                      </button>\r\n                    )}\r\n                  </article>\r\n                );\r\n              })\r\n            )}\r\n          </div>\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import { Routes, Route, Navigate } from \"react-router-dom\";\r\nimport UserMyPage from \"./UserMyPage\";\r\n\r\nexport default function MapFeature() {\r\n  return (\r\n    <div data-app=\"map\">\r\n      <Routes>\r\n        <Route index element={<UserMyPage />} />\r\n        <Route path=\"*\" element={<Navigate to=\".\" replace />} />\r\n      </Routes>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["FILTERS","WITH_CREDENTIALS","withCredentials","MyPage","_outletCtx$user","_outletCtx$user3","outletCtx","useOutletContext","initialUser","user","id","setUser","useState","loadingUser","setLoadingUser","reviews","setReviews","loadingReviews","setLoadingReviews","vouchers","setVouchers","loadingVouchers","setLoadingVouchers","voucherFilter","setVoucherFilter","email","initial","name","toString","slice","toUpperCase","displayName","username","useEffect","alive","_outletCtx$user2","data","api","_unused","_objectSpread","params","userId","Array","isArray","items","_unused2","fmtDate","d","undefined","dt","Date","isNaN","getTime","toISOString","s","String","trim","fetchVouchers","async","normalize","list","assumedFilter","map","v","_ref","_ref2","_ref3","_ref4","_v$id","_v$store","_v$mission","_v$mission2","_v$mission2$store","_ref5","_ref6","_ref7","_ref8","_v$validFrom","_ref9","_ref0","_ref1","_ref10","_ref11","_v$validTo","voucherId","voucherID","uuid","code","_id","rawStatus","vstatus","status","storeName","store","mission","pureTitle","rewardContent","rewardName","title","displayTitle","concat","start","validFrom","startAt","start_date","startDate","issuedAt","end","validTo","endAt","end_date","endDate","expireAt","expirationDate","effective","filter","statusList","results","Promise","all","f","then","_ref12","catch","merged","seen","Set","deduped","_ref13","_ref14","_ref15","_v$id2","vid","has","add","_unused3","statusMeta","useMemo","ALL","label","chip","ISSUED","USED","EXPIRED","reviewStatusMeta","APPROVED","PENDING","REJECTED","_jsxs","className","children","_jsx","_Fragment","length","review","statusKey","statusInfo","content","role","key","_statusMeta$key","type","onClick","_statusMeta$v$status$","_statusMeta$v$status","meta","window","confirm","e","_e$response","_e$response$data","msg","response","message","alert","handleUseVoucher","MapFeature","Routes","Route","index","element","UserMyPage","path","Navigate","to","replace"],"sourceRoot":""}